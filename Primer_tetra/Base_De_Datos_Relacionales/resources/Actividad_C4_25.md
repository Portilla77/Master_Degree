USE DATA_BANK;

CREATE TABLE SUCURSALES (
    ID_SUCURSAL INT PRIMARY KEY,
    NOMBRE VARCHAR(100) NOT NULL,
    CIUDAD VARCHAR(50) NOT NULL,
    ACTIVOS DECIMAL(15,2) NOT NULL
);

CREATE TABLE CLIENTES (
    ID_CLIENTE INT PRIMARY KEY,
    NOMBRE VARCHAR(100) NOT NULL,
    CALLE VARCHAR(100) NOT NULL,
    CIUDAD VARCHAR(50) NOT NULL
);

CREATE TABLE EMPLEADOS (
    ID_EMPLEADO INT PRIMARY KEY,
    NOMBRE VARCHAR(100) NOT NULL,
    TELEFONO VARCHAR(15) NOT NULL,
    FECHA_CONTRATO DATE NOT NULL,
    ANTIGUEDAD INT NOT NULL,
    ID_JEFE INT NULL, -- Relaci√≥n con el jefe del empleado
    FOREIGN KEY (ID_JEFE) REFERENCES EMPLEADOS(ID_EMPLEADO)
);

CREATE TABLE CLIENTE_BANQUERO (
    ID_CLIENTE INT NOT NULL,
    ID_EMPLEADO INT NOT NULL,
    PRIMARY KEY (ID_CLIENTE, ID_EMPLEADO),
    FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTES(ID_CLIENTE),
    FOREIGN KEY (ID_EMPLEADO) REFERENCES EMPLEADOS(ID_EMPLEADO)
);

CREATE TABLE CUENTAS (
    NUMERO_CUENTA INT PRIMARY KEY,
    SALDO DECIMAL(15,2) NOT NULL,
    FECHA_ULTIMO_ACCESO DATE NOT NULL
);

CREATE TABLE TIPOS_CUENTA (
    ID_TIPO_CUENTA INT PRIMARY KEY,
    TIPO_CUENTA VARCHAR(50) NOT NULL, -- 'Ahorro' o 'Corriente'
    TASA_INTERES DECIMAL(5,2), -- Solo para cuentas de ahorro
    DESCUBIERTO DECIMAL(15,2) -- Solo para cuentas corrientes
);

CREATE TABLE CUENTA_TIPO (
    NUMERO_CUENTA INT NOT NULL,
    ID_TIPO_CUENTA INT NOT NULL,
    PRIMARY KEY (NUMERO_CUENTA, ID_TIPO_CUENTA),
    FOREIGN KEY (NUMERO_CUENTA) REFERENCES CUENTAS(NUMERO_CUENTA),
    FOREIGN KEY (ID_TIPO_CUENTA) REFERENCES TIPOS_CUENTA(ID_TIPO_CUENTA)
);

CREATE TABLE CUENTA_CLIENTE (
    NUMERO_CUENTA INT NOT NULL,
    ID_CLIENTE INT NOT NULL,
    FECHA_ACCESO DATE NOT NULL,
    PRIMARY KEY (NUMERO_CUENTA, ID_CLIENTE),
    FOREIGN KEY (NUMERO_CUENTA) REFERENCES CUENTAS(NUMERO_CUENTA),
    FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTES(ID_CLIENTE)
);

CREATE TABLE PRESTAMOS (
    ID_PRESTAMO INT PRIMARY KEY,
    ID_SUCURSAL INT NOT NULL,
    IMPORTE DECIMAL(15,2) NOT NULL,
    FOREIGN KEY (ID_SUCURSAL) REFERENCES SUCURSALES(ID_SUCURSAL)
);

CREATE TABLE PRESTAMO_CLIENTE (
    ID_PRESTAMO INT NOT NULL,
    ID_CLIENTE INT NOT NULL,
    PRIMARY KEY (ID_PRESTAMO, ID_CLIENTE),
    FOREIGN KEY (ID_PRESTAMO) REFERENCES PRESTAMOS(ID_PRESTAMO),
    FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTES(ID_CLIENTE)
);

CREATE TABLE PAGOS_PRESTAMO (
    ID_PAGO INT NOT NULL,
    ID_PRESTAMO INT NOT NULL,
    IMPORTE DECIMAL(15,2) NOT NULL,
    FECHA_PAGO DATE NOT NULL,
    PRIMARY KEY (ID_PAGO, ID_PRESTAMO),
    FOREIGN KEY (ID_PRESTAMO) REFERENCES PRESTAMOS(ID_PRESTAMO)
);